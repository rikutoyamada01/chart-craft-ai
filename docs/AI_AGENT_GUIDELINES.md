# AIエージェント向けコードベース操作ガイドライン

このドキュメントは、AIエージェントが本プロジェクトのコードベースを操作する際の行動規範と手順を定めます。

## 1. 一般原則

-   **既存の規約への準拠:** 常に既存のコードスタイル、命名規約、アーキテクチャパターンを最優先します。変更を加える際は、周囲のコードに合わせます。
-   **安全性:** 破壊的な操作（ファイル削除、大規模な変更など）は、明示的なユーザーの確認なしには実行しません。非破壊的な変更を優先します。
-   **透明性:** 意図する変更内容や提案は、明確にユーザーに伝えます。
-   **可逆性:** 容易に元に戻せる変更を優先します。

## 2. コード実装ステップ

AIエージェントは、以下のステップで実装を進めます。

1.  **理解 (Understand):**
    -   ユーザーの要求と関連するコードベースのコンテキストを徹底的に分析します。
    -   `read_file`, `search_file_content`, `glob`などのツールを積極的に活用し、ファイル構造、既存のコードパターン、規約を把握します。
2.  **計画 (Plan):**
    -   明確で段階的な計画を策定します。
    -   重要な変更の場合は、計画をユーザーに提示し、承認を得ます。
3.  **実装 (Implement):**
    -   計画に基づき、変更を段階的に適用します。
    -   複雑な変更は、小さな単位に分割して実行します。
4.  **検証 (Verify):
    -   変更後には、関連するテスト、リンター、型チェッカー（例: `npm run lint`, `ruff check`, `tsc`）を実行し、コードの品質と機能が損なわれていないことを確認します。

## 3. コード規則（AI生成コード）

AIエージェントが生成または変更するコードは、以下の規則に従います。

-   **スタイル:** 周囲のコードのスタイル（インデント、改行、命名規則など）に完全に一致させます。
-   **可読性:** 明確で読みやすいコードを優先します。
-   **コメント:** コメントは控えめにし、複雑なロジックの「理由（Why）」に焦点を当てます。「何をしているか（What）」はコード自体で表現します。
-   **エラーハンドリング:** 堅牢なエラーハンドリングを実装します。
-   **セキュリティ:** 脆弱性（例: ハードコードされた秘密情報）を絶対に導入しません。

## 4. ディレクトリ構造

-   **既存構造の尊重:** 新しいファイルを作成したり、既存ファイルを移動したりする際は、常にプロジェクトの確立されたディレクトリ構造（例: `frontend/src/components`内のコンポーネント、`frontend/src/routes`内のページ）に従います。
-   **変更の提案:** 新しいディレクトリ構造が必要な場合は、まずユーザーに提案し、承認を得ます。

## 5. アーキテクチャ

-   **既存アーキテクチャへの準拠:** ユーザーからの明示的な指示がない限り、新しいアーキテクチャパターンやフレームワークを導入しません。
-   **ライブラリ/フレームワーク:** プロジェクトに既に存在する、またはユーザーによって明示的に承認されたライブラリ/フレームワークのみを使用します。使用前に`package.json`や`pyproject.toml`などで存在を確認します。

## 6. ユーザーとの対話

-   **曖昧さの明確化:** 曖昧な要求に対しては、明確化のための質問をします。
-   **重要なコマンドの説明:** ファイルシステムやシステムの状態を変更する可能性のあるコマンドを実行する前には、その目的と影響を説明します。
-   **主要な変更の確認:** 大規模な変更や削除については、必ずユーザーの確認を求めます。
